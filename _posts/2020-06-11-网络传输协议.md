### TCP/IP四层网络协议

#### 1、客户端

- 客户端（发送请求）
  - 传输层：使用TCP协议传输
  - 网络层：添加IP（相当于门牌号）
  - 数据转化层：添加MAC（相当于身份证）
  - 物理层：数据转化成二进制（比特流）进行传输
- 服务端
  - 物理层：接收二进制
  - 数据转化层：检查MAC的网卡地址和当前的网卡地址对比是否匹配
  - 网络层：检查ip是否是自己的不是则转发
  - 传输层：获取TCP头会携带端口，将报文送到指定的进程

### TCP传输可靠性

- 校验和：将发送的数据的以16位加起来，进一补在最后，取反，接收端收到数据同样的方式获取校验和然后做对比
- 确认答应和序列号：接收方每次接收到数据后，会响应一个ACK给发送端，发送端通过ACK知道下一次传输的起始位置
- 超时重传：当发送一段信息给接收端，接收端没有反馈ACK，服务端会将上次一发送包给重传
- 连接管理：三次握手
- 流量控制：发送端发送报文个接收端如果接收端反馈接收大小位0发送方停止发送，并定期发送试探包来确认是否可以发送。
- 拥堵控制：先发少量数据探，如果传输正常则扩大传输量*2，直到达到阈值

### HTTP特点

- 无状态没有记忆能力需反复登入
- HTTP1.1以前每次都需要3次握手和4次挥手
- 由客户端发起，服务端响应
- 简单快速灵活
- 无法确保数据完整性

### HTTPS通信过程

- HTTPS = HTTP+SSL/TLS协议，通过SSL/TLS数据加密解密，通过HTTP进行数据传输

- **混合加密：**HTTPS保证了安全了性能，数据进行对称加密，密钥进行非对称加密
- **数字摘要：**将明文进行hash
- **数字签名技术：**它把公钥加密技术和数字摘要结合起来，形成了实用的数字签名技术。

### HTTPS实现原理

- HTTPS内容传输使用对称加密，证书验证阶段使用非对称加密
- 证书验证阶段：
  - 客户端发起证书请求，服务端颁发证书，客户端验证证书的真伪
- 数据传输阶段:
  - 证书验证合法后，客户端生成随机数，客户端使用公钥对随机数加密
  - 服务端使用私钥解密获取客户端随机数
  - 服务端通过获取的随机数进行对称加密

### 为什么数据需要对称加密

- 对称加密效率快，非对称加密性能差
- 服务端只保存私密，公钥一次请求生成一次

### 如何确保证书合法性

- 颁发机构信息，公钥，公司信息，域名，有效期，指纹等





